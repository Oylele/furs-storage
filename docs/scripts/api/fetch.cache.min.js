(function(a){function b(a,b){let{headers:{"Content-type":c}}="headers"in b?b:{headers:{}},{body:d}=b;return b.cacheKey||a+(c||"")+(d||"")}function c(a){if(!a)return!1;if(!0===a)return self.localStorage;if("object"==typeof a&&"getItem"in a&&"removeItem"in a&&"setItem"in a)return a;throw new TypeError("localCache must either be a boolean value, or an object which implements the Storage interface.")}function d(a,b){a.removeItem(b),a.removeItem(b+"cachettl"),a.removeItem(b+"dataType")}function e(a,b,c,e){let f=e.clone(),g=(e.headers.get("Content-Type")||"text/plain").toLowerCase();return f.text().then(f=>{try{b.setItem(a,f),b.setItem(a+"cachettl",+new Date+3600000*c),b.setItem(a+"dataType",g)}catch(c){d(b,a),console.log("Cache Error: "+c,a,f)}}),e}function f(a,b){let c=new Response(a,{status:200,statusText:"success",headers:{"Content-Type":b}});return new Promise(function(a){a(c)})}a&&(self.fetch=function(g,h){let i,j,k,l=c(h.localCache),m=h.cacheTTL||5,n=b(g,h),o=h.isCacheValid;return l?(i=l.getItem(n+"cachettl"),o&&"function"==typeof o&&!o()&&(d(l,n),i=0),i&&i<+new Date&&d(l,n),j=l.getItem(n),!j)?a(g,h).then(e.bind(null,n,l,m)):(k=l.getItem(n+"dataType")||"text/plain",f(j,k)):a(g,h)})})(self.fetch);